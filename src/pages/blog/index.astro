---
import BaseLayout from '../../layouts/BaseLayout.astro';

// Get all blog posts
const posts = await Astro.glob('./*.mdx');

// Sort posts by date (newest first)
const sortedPosts = posts.sort((a, b) => {
  return new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime();
});
---

<BaseLayout title="Blog - Marius Ørvik" description="Thoughts on product strategy, AI, and building B2B SaaS products">
  <h1>Blog</h1>

  <p class="blog-intro">
    Thoughts on product strategy, AI, engineering leadership, and building B2B SaaS products.
  </p>

  {sortedPosts.length === 0 ? (
    <div class="empty-state">
      <p>No posts yet. Check back soon for insights on AI product strategy and B2B SaaS growth.</p>
    </div>
  ) : (
    <div class="posts-list">
      {sortedPosts.map((post) => {
        const formattedDate = new Date(post.frontmatter.date).toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });

        return (
          <article class="post-preview">
            <h2>
              <a href={post.url}>{post.frontmatter.title}</a>
            </h2>
            <div class="post-meta">
              <time datetime={post.frontmatter.date}>{formattedDate}</time>
            </div>
            <p class="post-excerpt">{post.frontmatter.description}</p>
            <a href={post.url} class="read-more">Read more →</a>
          </article>
        );
      })}
    </div>
  )}

  <style>
    .blog-intro {
      font-size: 1.1rem;
      color: var(--color-text-light);
      margin-bottom: 3rem;
      max-width: 600px;
    }

    .empty-state {
      padding: 3rem 2rem;
      background: #f9f9f9;
      border-radius: 8px;
      text-align: center;
    }

    .empty-state p {
      font-size: 1.1rem;
      color: var(--color-text-light);
      margin: 0;
    }

    .posts-list {
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
    }

    .post-preview {
      padding-bottom: 2rem;
      border-bottom: 1px solid var(--color-border);
    }

    .post-preview:last-child {
      border-bottom: none;
    }

    .post-preview h2 {
      font-size: 1.8rem;
      margin-top: 0;
      margin-bottom: 0.5rem;
    }

    .post-preview h2 a {
      color: var(--color-text);
      text-decoration: none;
      transition: color 0.2s;
    }

    .post-preview h2 a:hover {
      color: var(--color-accent);
    }

    .post-meta {
      color: var(--color-text-light);
      font-size: 0.95rem;
      margin-bottom: 0.8rem;
    }

    .post-excerpt {
      font-size: 1.05rem;
      line-height: 1.7;
      color: var(--color-text);
      margin-bottom: 1rem;
    }

    .read-more {
      color: var(--color-accent);
      font-weight: 500;
      text-decoration: none;
      transition: color 0.2s;
    }

    .read-more:hover {
      color: #0052a3;
    }

    @media (max-width: 768px) {
      .post-preview h2 {
        font-size: 1.5rem;
      }
    }
  </style>
</BaseLayout>
